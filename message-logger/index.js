(function(d,a,o,n){"use strict";const s=[],i=a.findByProps("_channelMessages"),r=a.findByProps("updateMessageRecord","createMessageRecord");a.findByName("MessageRecord",!1);const g=a.findByName("RowManager"),_=a.findByProps("getChannelId"),u="#ed4245",m="#ed424515",l=o.ReactNative.processColor;s.push(n.before("dispatch",o.FluxDispatcher,([e])=>{if(e.type==="MESSAGE_DELETE"){if(e.__vml_cleanup||e.channelId!==_.getChannelId())return e;const t=i.get(e.channelId)?.get(e.id);return!t||t.state==="SEND_FAILED"?e:[{type:"MESSAGE_UPDATE",message:{...t.toJS(),__vml_deleted:!0}}]}})),s.push(n.instead("updateMessageRecord",r,function([e,t],h){if(t.__vml_deleted){const c=r.createMessageRecord(t,e.reactions);return c.__vml_deleted=!0,c}return h.apply(this,[e,t])})),s.push(n.after("createMessageRecord",r,function([e],t){e.__vml_deleted&&(t.__vml_deleted=!0)})),s.push(n.after("generate",g.prototype,([e],t)=>{e.rowType===1&&e.message.__vml_deleted&&(t.message.timestampLabel&&!t.message.timestampLabel.includes("deleted")&&(t.message.timestampLabel+=" \u2022 (deleted)"),t.backgroundHighlight={backgroundColor:l(m),gutterColor:l(u)},t.message.avatarOpacity=.6,t.message.usernameOpacity=.6)}));const p=()=>{s.forEach(e=>e())},f={};return d.onUnload=p,d.settings=f,d})({},vendetta.metro,vendetta.metro.common,vendetta.patcher);
